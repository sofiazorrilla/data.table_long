<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Filtros y selección de columnas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
        <div class="quarto-navbar-tools ms-auto">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/sofiazorrilla/data.table_long/blob/main/README.md">
            Source Code
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tema3.html">Operaciones</a></li><li class="breadcrumb-item"><a href="./tema3.html">Filtros y selección de columnas</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introducción</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción y recursos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sintaxis básica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Importar y exportar datos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Operaciones</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Filtros y selección de columnas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modificación de columnas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Agrupación y cadenas de operaciones</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ejercicios</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uniones entre tablas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reformatear tablas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tema9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">.SD()</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#operaciones-sobre-las-filas" id="toc-operaciones-sobre-las-filas" class="nav-link active" data-scroll-target="#operaciones-sobre-las-filas">Operaciones sobre las filas</a>
  <ul class="collapse">
  <li><a href="#seleccionar-por-índices" id="toc-seleccionar-por-índices" class="nav-link" data-scroll-target="#seleccionar-por-índices">Seleccionar por índices</a></li>
  <li><a href="#filtrar-filas" id="toc-filtrar-filas" class="nav-link" data-scroll-target="#filtrar-filas">Filtrar filas</a></li>
  <li><a href="#ordenar-filas" id="toc-ordenar-filas" class="nav-link" data-scroll-target="#ordenar-filas">Ordenar filas</a></li>
  </ul></li>
  <li><a href="#operaciones-sobre-las-columnas" id="toc-operaciones-sobre-las-columnas" class="nav-link" data-scroll-target="#operaciones-sobre-las-columnas">Operaciones sobre las columnas</a>
  <ul class="collapse">
  <li><a href="#seleccionar-columnas-por-índice" id="toc-seleccionar-columnas-por-índice" class="nav-link" data-scroll-target="#seleccionar-columnas-por-índice">Seleccionar columnas por índice</a></li>
  <li><a href="#seleccionar-columnas-por-nombre" id="toc-seleccionar-columnas-por-nombre" class="nav-link" data-scroll-target="#seleccionar-columnas-por-nombre">Seleccionar columnas por nombre</a></li>
  <li><a href="#deseleccionar-columas" id="toc-deseleccionar-columas" class="nav-link" data-scroll-target="#deseleccionar-columas">Deseleccionar columas</a></li>
  <li><a href="#renombrar-columnas" id="toc-renombrar-columnas" class="nav-link" data-scroll-target="#renombrar-columnas">Renombrar columnas</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Filtros y selección de columnas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="operaciones-sobre-las-filas" class="level1">
<h1>Operaciones sobre las filas</h1>
<section id="seleccionar-por-índices" class="level2">
<h2 class="anchored" data-anchor-id="seleccionar-por-índices">Seleccionar por índices</h2>
<p>Similar a como se seleccionan filas en un data.frame, en un objeto data.table se pueden seleccionar filas utilizando rangos de índices. En los siguientes dos ejemplos se muestra como seleccionar las primeras dos filas de la tabla de registros.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">"data/universal_top_spotify_songs.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               spotify_id               name               artists daily_rank daily_movement weekly_movement country
                   &lt;char&gt;             &lt;char&gt;                &lt;char&gt;      &lt;int&gt;          &lt;int&gt;           &lt;int&gt;  &lt;char&gt;
1: 2plbrEY59IikOBgBGLjaoe   Die With A Smile Lady Gaga, Bruno Mars          1              0               0        
2: 6dOtVTDdiauQNBQEDOtlAB BIRDS OF A FEATHER         Billie Eilish          2              0               0        
   snapshot_date popularity is_explicit duration_ms           album_name album_release_date danceability energy   key
          &lt;IDat&gt;      &lt;int&gt;      &lt;lgcl&gt;       &lt;int&gt;               &lt;char&gt;             &lt;IDat&gt;        &lt;num&gt;  &lt;num&gt; &lt;int&gt;
1:    2024-09-08         97       FALSE      251667     Die With A Smile         2024-08-16        0.521  0.592     6
2:    2024-09-08        100       FALSE      210373 HIT ME HARD AND SOFT         2024-05-17        0.747  0.507     2
   loudness  mode speechiness acousticness instrumentalness liveness valence   tempo time_signature
      &lt;num&gt; &lt;int&gt;       &lt;num&gt;        &lt;num&gt;            &lt;num&gt;    &lt;num&gt;   &lt;num&gt;   &lt;num&gt;          &lt;int&gt;
1:   -7.777     0      0.0304        0.308           0.0000    0.122   0.535 157.969              3
2:  -10.171     1      0.0358        0.200           0.0608    0.117   0.438 104.978              4</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Nota:</strong> Cuando solo estamos seleccionando filas no es necesario incluir la coma al final.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               spotify_id               name               artists daily_rank daily_movement weekly_movement country
                   &lt;char&gt;             &lt;char&gt;                &lt;char&gt;      &lt;int&gt;          &lt;int&gt;           &lt;int&gt;  &lt;char&gt;
1: 2plbrEY59IikOBgBGLjaoe   Die With A Smile Lady Gaga, Bruno Mars          1              0               0        
2: 6dOtVTDdiauQNBQEDOtlAB BIRDS OF A FEATHER         Billie Eilish          2              0               0        
   snapshot_date popularity is_explicit duration_ms           album_name album_release_date danceability energy   key
          &lt;IDat&gt;      &lt;int&gt;      &lt;lgcl&gt;       &lt;int&gt;               &lt;char&gt;             &lt;IDat&gt;        &lt;num&gt;  &lt;num&gt; &lt;int&gt;
1:    2024-09-08         97       FALSE      251667     Die With A Smile         2024-08-16        0.521  0.592     6
2:    2024-09-08        100       FALSE      210373 HIT ME HARD AND SOFT         2024-05-17        0.747  0.507     2
   loudness  mode speechiness acousticness instrumentalness liveness valence   tempo time_signature
      &lt;num&gt; &lt;int&gt;       &lt;num&gt;        &lt;num&gt;            &lt;num&gt;    &lt;num&gt;   &lt;num&gt;   &lt;num&gt;          &lt;int&gt;
1:   -7.777     0      0.0304        0.308           0.0000    0.122   0.535 157.969              3
2:  -10.171     1      0.0358        0.200           0.0608    0.117   0.438 104.978              4</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="filtrar-filas" class="level2">
<h2 class="anchored" data-anchor-id="filtrar-filas">Filtrar filas</h2>
<p>De acuerdo con la sintaxis del paquete, el espacio i es el lugar en el que se pueden realizar operaciones sobre las filas como los filtros. Por ejemplo, utilizando la tabla de canciones podríamos estar interesados en solo seleccionar aquellos registros que pertenezcan a México.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_MX <span class="ot">&lt;-</span> data[country <span class="sc">==</span> <span class="st">"MX"</span>,] </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_MX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16256    25</code></pre>
</div>
</div>
<p>O podríamos estar interesadas en seleccionar solo los registros más viejos, los que fueron publicados antes del 2000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_MX_viejos <span class="ot">&lt;-</span> data[country <span class="sc">==</span> <span class="st">"MX"</span> <span class="sc">&amp;</span> album_release_date <span class="sc">&lt;=</span> <span class="dv">2000</span>,]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_MX_viejos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2 25</code></pre>
</div>
</div>
<p>Operadores lógicos para hacer los filtros:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Operador</th>
<th style="text-align: center;">Comparación</th>
<th style="text-align: center;">Ejemplo</th>
<th style="text-align: center;">Resultado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">x | y</td>
<td style="text-align: center;">x Ó y es verdadero</td>
<td style="text-align: center;">TRUE | FALSE</td>
<td style="text-align: center;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: center;">x &amp; y</td>
<td style="text-align: center;">x Y y son verdaderos</td>
<td style="text-align: center;">TRUE &amp; FALSE</td>
<td style="text-align: center;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: center;">!x</td>
<td style="text-align: center;">x no es verdadero (negación)</td>
<td style="text-align: center;">!TRUE</td>
<td style="text-align: center;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: center;">isTRUE(x)</td>
<td style="text-align: center;">x es verdadero (afirmación)</td>
<td style="text-align: center;">isTRUE(TRUE)</td>
<td style="text-align: center;">TRUE</td>
</tr>
</tbody>
</table>
<p><br></p>
</section>
<section id="ordenar-filas" class="level2">
<h2 class="anchored" data-anchor-id="ordenar-filas">Ordenar filas</h2>
<p>Otra función que se puede realizar en el espacio de las filas es ordenarlas. Por ejemplo, podríamos ordenar la tabla de canciones de México por qué tan bailable es.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenar los datos de la tabla por qué tan bailable es</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ordered_data_MX <span class="ot">=</span> data_MX[<span class="fu">order</span>(danceability, <span class="at">decreasing =</span> T)]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionar la columna de danceability como vector y seleccionar los valores únicos</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># mostrar solo los primeros valores</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ordered_data_MX<span class="sc">$</span>danceability) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.937 0.924 0.922 0.920 0.918 0.913</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reto
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Carga el archivo de canciones utilizando la función fread que revisamos en el tema anterior</li>
<li>Utiliza un filtro para quedarte con las filas que pertenezcan al pais que te interese</li>
<li>Ordena de manera descendente por ranking</li>
</ol>
<p>Pregunta:</p>
<p>¿De qué rango de años son las 50 canciones más escuchadas?</p>
<p>Nota: Cuando tienes una columna de fecha con formato Año-mes-dia pero solo quieres la información de alguno de los elementos (por ejemplo el año) puedes utilizar la siguiente función: <code>format(data_MX_ordenado$album_release_date,"%Y")</code></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Respuesta
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mexico: 1963 - 2024"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br> <br></p>
</section>
</section>
<section id="operaciones-sobre-las-columnas" class="level1">
<h1>Operaciones sobre las columnas</h1>
<section id="seleccionar-columnas-por-índice" class="level2">
<h2 class="anchored" data-anchor-id="seleccionar-columnas-por-índice">Seleccionar columnas por índice</h2>
<p>De acuerdo con la sintaxis del paquete, el espacio j nos permite realizar operaciones sobre las columnas. Una de esas operaciones es la selección de columnas.</p>
<p>Se pueden seleccionar por medio de índices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">7</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      name                     artists country
                                    &lt;char&gt;                      &lt;char&gt;  &lt;char&gt;
      1:                  Die With A Smile       Lady Gaga, Bruno Mars        
      2:                BIRDS OF A FEATHER               Billie Eilish        
      3:                             Taste           Sabrina Carpenter        
      4:                          Espresso           Sabrina Carpenter        
      5:                               Who                       Jimin        
     ---                                                                      
1179449:         Slime You Out (feat. SZA)                  Drake, SZA      AE
1179450: SAY MY GRACE (feat. Travis Scott)        Offset, Travis Scott      AE
1179451:                            People                    Libianca      AE
1179452:                        Rainy Days                           V      AE
1179453:                             Prada cassö, RAYE, D-Block Europe      AE</code></pre>
</div>
</div>
</section>
<section id="seleccionar-columnas-por-nombre" class="level2">
<h2 class="anchored" data-anchor-id="seleccionar-columnas-por-nombre">Seleccionar columnas por nombre</h2>
<p>Se pueden seleccionar las columas por nombre y regresar como vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data[,name] <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Die With A Smile"             "BIRDS OF A FEATHER"           "Taste"                       
[4] "Espresso"                     "Who"                          "Si Antes Te Hubiera Conocido"</code></pre>
</div>
</div>
<p>Se pueden seleccionar las columnas usando una lista y regresar como tabla:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data[,<span class="fu">list</span>(artists,name,album_name)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             artists                              name           album_name
                              &lt;char&gt;                            &lt;char&gt;               &lt;char&gt;
      1:       Lady Gaga, Bruno Mars                  Die With A Smile     Die With A Smile
      2:               Billie Eilish                BIRDS OF A FEATHER HIT ME HARD AND SOFT
      3:           Sabrina Carpenter                             Taste       Short n' Sweet
      4:           Sabrina Carpenter                          Espresso       Short n' Sweet
      5:                       Jimin                               Who                 MUSE
     ---                                                                                   
1179449:                  Drake, SZA         Slime You Out (feat. SZA)     For All The Dogs
1179450:        Offset, Travis Scott SAY MY GRACE (feat. Travis Scott)           SET IT OFF
1179451:                    Libianca                            People               People
1179452:                           V                        Rainy Days              Layover
1179453: cassö, RAYE, D-Block Europe                             Prada                Prada</code></pre>
</div>
</div>
<p>Un atajo para no escribir <code>list()</code> es <code>.()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data[,.(artists,name,album_name)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             artists                              name           album_name
                              &lt;char&gt;                            &lt;char&gt;               &lt;char&gt;
      1:       Lady Gaga, Bruno Mars                  Die With A Smile     Die With A Smile
      2:               Billie Eilish                BIRDS OF A FEATHER HIT ME HARD AND SOFT
      3:           Sabrina Carpenter                             Taste       Short n' Sweet
      4:           Sabrina Carpenter                          Espresso       Short n' Sweet
      5:                       Jimin                               Who                 MUSE
     ---                                                                                   
1179449:                  Drake, SZA         Slime You Out (feat. SZA)     For All The Dogs
1179450:        Offset, Travis Scott SAY MY GRACE (feat. Travis Scott)           SET IT OFF
1179451:                    Libianca                            People               People
1179452:                           V                        Rainy Days              Layover
1179453: cassö, RAYE, D-Block Europe                             Prada                Prada</code></pre>
</div>
</div>
<p>Seleccionar columnas por rangos usando nombres:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data[,spotify_id<span class="sc">:</span>weekly_movement]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     spotify_id                              name                     artists daily_rank daily_movement
                         &lt;char&gt;                            &lt;char&gt;                      &lt;char&gt;      &lt;int&gt;          &lt;int&gt;
      1: 2plbrEY59IikOBgBGLjaoe                  Die With A Smile       Lady Gaga, Bruno Mars          1              0
      2: 6dOtVTDdiauQNBQEDOtlAB                BIRDS OF A FEATHER               Billie Eilish          2              0
      3: 5G2f63n7IPVPPjfNIGih7Q                             Taste           Sabrina Carpenter          3              0
      4: 2HRqTpkrJO5ggZyyK6NPWz                          Espresso           Sabrina Carpenter          4             46
      5: 7tI8dRuH2Yc6RuoTjxo4dU                               Who                       Jimin          5              0
     ---                                                                                                               
1179449: 0AYt6NMyyLd0rLuvr0UkMH         Slime You Out (feat. SZA)                  Drake, SZA         46              4
1179450: 2Gk6fi0dqt91NKvlzGsmm7 SAY MY GRACE (feat. Travis Scott)        Offset, Travis Scott         47              3
1179451: 26b3oVLrRUaaybJulow9kz                            People                    Libianca         48              2
1179452: 5ydjxBSUIDn26MFzU3asP4                        Rainy Days                           V         49              1
1179453: 59NraMJsLaMCVtwXTSia8i                             Prada cassö, RAYE, D-Block Europe         50              0
         weekly_movement
                   &lt;int&gt;
      1:               0
      2:               0
      3:               0
      4:              46
      5:               0
     ---                
1179449:               0
1179450:               0
1179451:               0
1179452:               0
1179453:               0</code></pre>
</div>
</div>
<p>Para seleccionar columnas guardadas en una variable se puede utilizar el prefijo <code>..</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"artists"</span>,<span class="st">"name"</span>,<span class="st">"album_name"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>data[ , ..variables]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             artists                              name           album_name
                              &lt;char&gt;                            &lt;char&gt;               &lt;char&gt;
      1:       Lady Gaga, Bruno Mars                  Die With A Smile     Die With A Smile
      2:               Billie Eilish                BIRDS OF A FEATHER HIT ME HARD AND SOFT
      3:           Sabrina Carpenter                             Taste       Short n' Sweet
      4:           Sabrina Carpenter                          Espresso       Short n' Sweet
      5:                       Jimin                               Who                 MUSE
     ---                                                                                   
1179449:                  Drake, SZA         Slime You Out (feat. SZA)     For All The Dogs
1179450:        Offset, Travis Scott SAY MY GRACE (feat. Travis Scott)           SET IT OFF
1179451:                    Libianca                            People               People
1179452:                           V                        Rainy Days              Layover
1179453: cassö, RAYE, D-Block Europe                             Prada                Prada</code></pre>
</div>
</div>
<p>Nota: Tanto los objetos data.frame como los data.table son listas (aun cuando las vemos como tablas). El hecho de que las operaciones realizadas en el espacio j regresen listas es muy poderoso y permite hacer operaciones más complicadas más adelante.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reto
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A. Me gustaría tener un data frame en donde solo tuviera la información de las características de las canciones (por ejemplo: duración, energía, etc.)</p>
<ol type="1">
<li>Enlista los nombres de columnas y analiza de qué tratan</li>
<li>Guarda los nombres de las columnas que solo contengan información acerca las características en un objeto</li>
<li>Selecciona las columnas de la tabla data usando el objeto de nombres de columnas.</li>
</ol>
<p>B. Genera un objeto data.table que tenga los registros del mes de septiembre 2024 y las columnas que describen las características de las cancions (utiliza un solo comando).</p>
<p>Nota: Cuando tienes una columna de fecha con formato Año-mes-dia pero solo quieres la información de algunos de los elementos (por ejemplo el año y mes) puedes utilizar la siguiente función: <code>format(data_MX_ordenado$album_release_date,"%Y-%m")</code></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Respuesta
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>info_canciones &lt;- c(“duration_ms”, “danceability”, “energy”, “loudness”, “speechiness”, “acousticness”,“instrumentalness”,“liveness”)</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         duration_ms danceability energy loudness speechiness acousticness instrumentalness liveness
               &lt;int&gt;        &lt;num&gt;  &lt;num&gt;    &lt;num&gt;       &lt;num&gt;        &lt;num&gt;            &lt;num&gt;    &lt;num&gt;
      1:      251667        0.521  0.592   -7.777      0.0304      0.30800         0.00e+00    0.122
      2:      210373        0.747  0.507  -10.171      0.0358      0.20000         6.08e-02    0.117
      3:      157279        0.674  0.907   -4.086      0.0640      0.10100         0.00e+00    0.297
      4:      175459        0.699  0.776   -5.282      0.0293      0.13100         5.36e-06    0.205
      5:      170887        0.660  0.756   -3.743      0.0320      0.00289         0.00e+00    0.193
     ---                                                                                            
1179449:      310490        0.483  0.408   -9.243      0.0502      0.50800         0.00e+00    0.259
1179450:      173253        0.773  0.635   -5.060      0.0452      0.05850         0.00e+00    0.132
1179451:      184791        0.573  0.422   -7.621      0.0678      0.55100         1.31e-05    0.102
1179452:      179560        0.633  0.454   -8.016      0.0875      0.73900         0.00e+00    0.148
1179453:      132359        0.638  0.717   -5.804      0.0375      0.00100         1.79e-06    0.113</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       snapshot_date duration_ms danceability energy loudness speechiness acousticness instrumentalness liveness
              &lt;IDat&gt;       &lt;int&gt;        &lt;num&gt;  &lt;num&gt;    &lt;num&gt;       &lt;num&gt;        &lt;num&gt;            &lt;num&gt;    &lt;num&gt;
    1:    2024-09-08      251667        0.521  0.592   -7.777      0.0304      0.30800         0.00e+00   0.1220
    2:    2024-09-08      210373        0.747  0.507  -10.171      0.0358      0.20000         6.08e-02   0.1170
    3:    2024-09-08      157279        0.674  0.907   -4.086      0.0640      0.10100         0.00e+00   0.2970
    4:    2024-09-08      175459        0.699  0.776   -5.282      0.0293      0.13100         5.36e-06   0.2050
    5:    2024-09-08      170887        0.660  0.756   -3.743      0.0320      0.00289         0.00e+00   0.1930
   ---                                                                                                          
29196:    2024-09-01      140733        0.882  0.764   -5.241      0.2040      0.35900         0.00e+00   0.1190
29197:    2024-09-01      180000        0.840  0.715   -5.141      0.1870      0.17600         0.00e+00   0.0935
29198:    2024-09-01      241000        0.330  0.313  -10.906      0.0353      0.53600         5.70e-06   0.2770
29199:    2024-09-01      131872        0.749  0.729   -3.190      0.0321      0.26100         0.00e+00   0.1130
29200:    2024-09-01      151739        0.804  0.957   -5.452      0.0340      0.12500         1.74e-02   0.1140</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="deseleccionar-columas" class="level2">
<h2 class="anchored" data-anchor-id="deseleccionar-columas">Deseleccionar columas</h2>
<p>Similar a las formas de seleccionar columnas podemos utilizar los operadores <code>-</code> y <code>!</code> para evitar la selección de ciertas columnas o rangos de columnas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data[,<span class="sc">-</span><span class="fu">c</span>(<span class="st">"name"</span>,<span class="st">"artists"</span>)] <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "spotify_id"         "daily_rank"         "daily_movement"     "weekly_movement"    "country"           
 [6] "snapshot_date"      "popularity"         "is_explicit"        "duration_ms"        "album_name"        
[11] "album_release_date" "danceability"       "energy"             "key"                "loudness"          
[16] "mode"               "speechiness"        "acousticness"       "instrumentalness"   "liveness"          
[21] "valence"            "tempo"              "time_signature"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data[,<span class="sc">!</span><span class="fu">c</span>(<span class="st">"spotify_id"</span>)] <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "name"               "artists"            "daily_rank"         "daily_movement"     "weekly_movement"   
 [6] "country"            "snapshot_date"      "popularity"         "is_explicit"        "duration_ms"       
[11] "album_name"         "album_release_date" "danceability"       "energy"             "key"               
[16] "loudness"           "mode"               "speechiness"        "acousticness"       "instrumentalness"  
[21] "liveness"           "valence"            "tempo"              "time_signature"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data[,<span class="sc">!</span>(key<span class="sc">:</span>time_signature)] <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "spotify_id"         "name"               "artists"            "daily_rank"         "daily_movement"    
 [6] "weekly_movement"    "country"            "snapshot_date"      "popularity"         "is_explicit"       
[11] "duration_ms"        "album_name"         "album_release_date" "danceability"       "energy"            </code></pre>
</div>
</div>
</section>
<section id="renombrar-columnas" class="level2">
<h2 class="anchored" data-anchor-id="renombrar-columnas">Renombrar columnas</h2>
<p>En el espacio de operaciones sobre las columnas también se pueden renombrar las columnas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data[, .(<span class="at">artista =</span> artists, <span class="at">song_name =</span> name)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             artista                         song_name
                              &lt;char&gt;                            &lt;char&gt;
      1:       Lady Gaga, Bruno Mars                  Die With A Smile
      2:               Billie Eilish                BIRDS OF A FEATHER
      3:           Sabrina Carpenter                             Taste
      4:           Sabrina Carpenter                          Espresso
      5:                       Jimin                               Who
     ---                                                              
1179449:                  Drake, SZA         Slime You Out (feat. SZA)
1179450:        Offset, Travis Scott SAY MY GRACE (feat. Travis Scott)
1179451:                    Libianca                            People
1179452:                           V                        Rainy Days
1179453: cassö, RAYE, D-Block Europe                             Prada</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>